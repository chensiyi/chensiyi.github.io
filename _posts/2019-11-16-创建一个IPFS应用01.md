---
layout: post
title: 创建一个IPFS应用01
date: 2019-11-16
image: "/images/pic_start.jpg"
tags: ipfs
---

可能你进行了热身，已经跃跃欲试了，那我们来设计制作第一个自己的IPFS应用吧。

<b>目标<b>  
做一个评论区

这是一个简洁而不乏挑战的命题。

首先我们来评估一下这个需求大体的使用场景和功能：
 1. 通过IPFS构建，没有传统的中心服务器
 2. 评论的添加
 3. 用户认证和权限
    
这些是我们优先满足的功能点。

## 设计
这个应用比较小，也谈不上设计。为了说明应用的大体运作流程，这里进行一个粗略的介绍。  
评论区与经典的聊天室不同，它支持离线消息，而又对实时性要求不高。
针对整个应用，我的设计为所有的信息，通过IPNS进行发布，由客户端将所需信息进行读取和展示。
它包含以下部分：
- 评论区目录： `/ipns/<nodeId>`
评论区由博主生成，包含注册用户信息，也可包含缓存信息。客户端通过读取缓存信息或者加载注册用户的IPNS节点来展示评论信息。  
 node/users/userId1  //注册用户的peerId  
 node/users/userId2  
 node/comments/articleA/userId1Comments/  //用户对文章articleA的评论 缓存信息  
 ...     
 
  评论区记录的两类信息：
  - 注册用户的peerId  
  由评论区所有者管理，通过更新users目录完成对注册会员的添加和删除。只有注册用户才有权限进行评论。
  特别的，我们可以公开一个账户作为匿名账户。
  - 缓存信息  
  缓存信息不是必要的，它是对某一时刻的评论快照，他的存在具有以下作用：
    1. 加速客户端读取一部分博主已经承认的评论数据
    2. 评论内容的版本跟踪
    3. 保存被注销账户的评论
 
- 用户目录  `/ipns/<nodeId>`
用户目录由用户自行创建，通过完成注册生效。任何人可以单独为使用某个评论区创建全新的用户目录，也可在已有节点上添加信息。  
 node/comments_cache/articleA/comment-id //用户对文章articleA的评论  
 ...  
 

## 问题讨论

### 这个应用解决了什么问题？

为了更准确的描述这个应用，我重新介绍一下：

### 应用摆脱了对中心服务器的依赖，展示了一个构建新一代网络存储系统之上的弱计算应用的简单原型。使用者可以花费最小的开发和维护成本，在极大的网络范围进行数据共享 ###

凡使用类似设计的应用，在牺牲了一定的本地磁盘存储效率后，都可以获得以下能力的提升：
 - 版本管理的支持
 - 默认支持CDN
 - 内容共享，包括内容的存储和传递都可以进行全网共（监）享（控）
 - 存储和计算资源分离，资源占用按需升级

### 反思，IPFS的意义
IPFS是一个分布式软件系统的一环。
它对网络生态的构想是理性的，他的设计是模仿市场的（见[FileCoin项目](https://filecoin.io/)）。
以经济学的观点看，它好比自由市场，把货物（数据）进行挂牌，并组织交易行为。这种演变符合一项基本的历史规律：运输费用大幅降低。
<!-- 饿了，累了，迷茫了，害怕了 -->
真的去分析的话，我们能列出一整张A4的进步点，更能写出一整本书的前景瞻望。只是现在网络技术已有极大的历史包袱，升级成本远非常人可以想象。
